% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Estonia_Processor.R
\name{process_estonia_bsi}
\alias{process_estonia_bsi}
\title{Process Estonia BSI data from raw format to EHR-BSI format}
\usage{
process_estonia_bsi(
  input_file = "BSI_REPORT_2024_share.xlsx",
  input_file_path = NULL,
  dictionary_path = NULL,
  value_maps_path = "reference/raw_BSI_valueMaps.r",
  metadata_path = "reference/MetaDataSet_57 (2025-03-13).xlsx",
  reporting_year = as.numeric(format(Sys.Date(), "\%Y")),
  episode_duration = 14,
  write_to_file = FALSE,
  write_to_file_path = NULL,
  return_format = "list"
)
}
\arguments{
\item{input_file}{Name of the input Excel file, defaults to "BSI_REPORT_2024_share.xlsx"}

\item{input_file_path}{Path to the input file, defaults to the working directory}

\item{dictionary_path}{Path to the data dictionary Excel file}

\item{value_maps_path}{Path to the value maps R script}

\item{metadata_path}{Path to the metadata Excel file for antibiotic recoding}

\item{reporting_year}{Year for the DateUsedForStatistics field, defaults to current year}

\item{episode_duration}{Duration for episode calculation in days, defaults to 14}

\item{write_to_file}{Whether to write output files to disk}

\item{write_to_file_path}{Path for output files, defaults to working directory}

\item{return_format}{Whether to return "list" (default) or "separate" objects}
}
\value{
Returns a list containing the four EHR-BSI data tables: ehrbsi, patient, isolate, res
}
\description{
Process Estonia BSI data from raw format to EHR-BSI format
}
\examples{
\dontrun{
result <- process_estonia_bsi(
  input_file_path = "Estonia/data/raw",
  dictionary_path = "Estonia/data/reference/dictionary_raw_BSI_Estonia.xlsx",
  write_to_file = TRUE,
  write_to_file_path = "Estonia/data/formatted"
)
}
} 